{% extends "base.html" %}
{% load static %}

{% block title %}
  Home | Iberica News
{% endblock %}

{% block content %}

  {% if featured_posts %}
    {% with featured_main=featured_posts.0 featured_secondary=featured_posts|slice:"1:" %}

      {# ---------- HERO FEATURED ---------- #}
      {% if featured_main %}
        <section
          class="featured-hero jumbotron mt-4 text-white rounded shadow-lg"
          aria-labelledby="top-story-heading"
          style="
            background:
              linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)),
              url('{% if featured_main.featured_image and featured_main.featured_image.url != 'placeholder' %}{{ featured_main.featured_image.url }}{% else %}{% static 'image/blogNews.png' %}{% endif %}')
              center / cover no-repeat;
          "
        >
          <div class="text-center py-4">

            <h1 id="top-story-heading" class="featured-title">
              Top Story of the Day
            </h1>

            <h2 class="featured-post-title text-warning">
              {{ featured_main.title }}
            </h2>

            <p class="featured-subtext">
              Breaking news, in-depth reporting, and stories that matter.
            </p>

            <a
              href="{% url 'post_detail' featured_main.slug %}"
              class="btn btn-warning font-weight-bold"
              aria-label="Read full article: {{ featured_main.title }}"
            >
              Read more â†’
            </a>

          </div>
        </section>
      {% endif %}

      {# ---------- SECONDARY FEATURED ---------- #}
      {% if featured_secondary %}
        <h2 class="section-heading text-warning text-center my-5">
          More Featured
        </h2>

        <div class="row mb-5">
          {% for post in featured_secondary %}
            <div class="col-md-6 mb-4">
              <article class="card border-0 h-100 shadow-sm hover-shadow">
                <div class="card-body d-flex flex-column">

                  <h3 class="h4 card-title">
                    <a
                      href="{% url 'post_detail' post.slug %}"
                      class="text-dark text-decoration-none"
                    >
                      {{ post.title }}
                    </a>
                  </h3>

                  <p class="post-meta text-muted mb-3">
                    {{ post.created_on|timesince }} ago â€¢
                    {{ post.author.get_full_name|default:post.author.username }}
                  </p>

                  <p class="card-text text-muted flex-grow-1">
                    {{ post.content|striptags|truncatewords:26 }}
                  </p>

                  <a
                    href="{% url 'post_detail' post.slug %}"
                    class="btn btn-sm btn-outline-warning align-self-start"
                  >
                    Read more â†’
                  </a>

                </div>
              </article>
            </div>
          {% endfor %}
        </div>
      {% endif %}

    {% endwith %}
  {% endif %}

  {# ===================== RECENT ARTICLES ===================== #}

  <div class="container px-0">

    <hr class="section-divider">

    <h2 class="section-heading text-warning text-center mb-4">
      Recent Articles
    </h2>

    <div class="row">
      {% for post in posts %}
        <div class="col-12 col-md-6 col-lg-4 mb-4">
          <article class="card border-0 h-100 shadow-sm hover-shadow">
            <div class="card-body d-flex flex-column">

              <h3 class="h6 card-title">
                <a
                  href="{% url 'post_detail' post.slug %}"
                  class="text-dark text-decoration-none"
                >
                  {{ post.title }}
                </a>
              </h3>

              <p class="post-meta text-muted mb-3">
                {{ post.created_on|timesince }} ago â€¢
                {{ post.author.get_full_name|default:post.author.username }}
              </p>

              <p class="card-text text-secondary flex-grow-1">
                {{ post.content|striptags|truncatewords:22 }}
              </p>

              <a
                href="{% url 'post_detail' post.slug %}"
                class="btn btn-sm btn-outline-warning align-self-start"
              >
                Read more â†’
              </a>

            </div>
          </article>
        </div>
      {% endfor %}

      {# ===== DYNAMIC PLACEHOLDERS ===== #}
      {% for _ in placeholders %}
        <div class="col-12 col-md-6 col-lg-4 mb-4">
          <article class="card border-0 h-100 shadow-sm bg-light text-center">
            <div class="card-body d-flex flex-column justify-content-center">

              <h4 class="text-muted mb-2">
                More blogs coming soon
              </h4>

              <p class="small text-muted mb-0">
                Stay tuned ðŸ‘€
              </p>

            </div>
          </article>
        </div>
      {% endfor %}

    </div>

  </div>

{% endblock %}
